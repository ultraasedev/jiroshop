2025-01-03 15:37:33 [INFO]: ✅ Connecté à MongoDB | {"metadata":{}}
2025-01-03 15:37:33 [INFO]: ✅ Tous les index ont été supprimés | {"metadata":{}}
2025-01-03 15:37:34 [INFO]: ✅ Nouveaux index créés | {"metadata":{}}
2025-01-03 15:37:34 [ERROR]: ❌ Erreur lors de l'initialisation: Plan executor error during findAndModify :: caused by :: E11000 duplicate key error collection: test.categories index: slug_1 dup key: { slug: null } | {"metadata":{"errorResponse":{"ok":0,"errmsg":"Plan executor error during findAndModify :: caused by :: E11000 duplicate key error collection: test.categories index: slug_1 dup key: { slug: null }","code":11000,"codeName":"DuplicateKey","keyPattern":{"slug":1},"keyValue":{"slug":null},"$clusterTime":{"clusterTime":{"$timestamp":"7455698372679172100"},"signature":{"hash":"CACRYJlJ5JyR3Ae+mjvF5BIWKpc=","keyId":{"low":5,"high":1726158476,"unsigned":false}}},"operationTime":{"$timestamp":"7455698372679172100"}},"ok":0,"code":11000,"codeName":"DuplicateKey","keyPattern":{"slug":1},"keyValue":{"slug":null},"$clusterTime":{"clusterTime":{"$timestamp":"7455698372679172100"},"signature":{"hash":"CACRYJlJ5JyR3Ae+mjvF5BIWKpc=","keyId":{"low":5,"high":1726158476,"unsigned":false}}},"operationTime":{"$timestamp":"7455698372679172100"},"stack":"MongoServerError: Plan executor error during findAndModify :: caused by :: E11000 duplicate key error collection: test.categories index: slug_1 dup key: { slug: null }\n    at Connection.sendCommand (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\cmap\\connection.js:296:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async Connection.command (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\cmap\\connection.js:323:26)\n    at async Server.command (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\sdam\\server.js:170:29)\n    at async FindOneAndUpdateOperation.executeCommand (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\operations\\command.js:76:16)\n    at async FindOneAndUpdateOperation.execute (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\operations\\find_and_modify.js:85:24)\n    at async tryOperation (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\operations\\execute_operation.js:203:20)\n    at async executeOperation (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\operations\\execute_operation.js:73:16)\n    at async Collection.findOneAndUpdate (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\collection.js:500:16)\n    at async model.Query._findOneAndUpdate (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongoose\\lib\\query.js:3459:13)"}}
2025-01-03 15:39:44 [INFO]: MongoDB connecté | {"metadata":{}}
2025-01-03 16:12:15 [INFO]: ✅ Connecté à MongoDB | {"metadata":{}}
2025-01-03 16:12:15 [INFO]: ✅ Tous les index ont été supprimés | {"metadata":{}}
2025-01-03 16:12:15 [INFO]: ✅ Nouveaux index créés | {"metadata":{}}
2025-01-03 16:12:15 [INFO]: ✅ Catégories par défaut créées | {"metadata":{}}
2025-01-03 16:12:15 [INFO]: ✅ Admin par défaut créé | {"metadata":{}}
2025-01-03 16:12:31 [INFO]: MongoDB connecté | {"metadata":{}}
2025-01-03 16:36:10 [INFO]: MongoDB connecté | {"metadata":{}}
2025-01-03 16:43:41 [INFO]: MongoDB connecté | {"metadata":{}}
2025-01-03 16:54:33 [INFO]: MongoDB connecté | {"metadata":{}}
2025-01-03 16:55:18 [INFO]: MongoDB connecté | {"metadata":{}}
2025-01-03 16:57:49 [INFO]: MongoDB connecté | {"metadata":{}}
2025-01-03 17:02:32 [INFO]: MongoDB connecté | {"metadata":{}}
2025-01-03 17:02:32 [INFO]: Base de données connectée | {"metadata":{}}
2025-01-03 17:02:32 [INFO]: Middlewares configurés | {"metadata":{}}
2025-01-03 17:02:32 [INFO]: Tâches périodiques de commandes démarrées | {"metadata":{}}
2025-01-03 17:02:32 [INFO]: Contrôleurs initialisés | {"metadata":{}}
2025-01-03 17:02:32 [INFO]: Commandes administrateur configurées | {"metadata":{}}
2025-01-03 17:02:32 [INFO]: Gestion des erreurs configurée | {"metadata":{}}
2025-01-03 17:03:14 [INFO]: Utilisateur mis à jour: | {"metadata":{"telegramId":"5232913097","username":"unknowusername2","role":"admin","status":"active"}}
2025-01-03 17:03:14 [WARN]: Comportement suspect détecté: | {"metadata":{"userId":5232913097}}
2025-01-03 17:04:30 [WARN]: Comportement suspect détecté: | {"metadata":{"userId":5232913097}}
2025-01-03 17:08:31 [WARN]: Comportement suspect détecté: | {"metadata":{"userId":5232913097}}
2025-01-03 17:08:52 [WARN]: Type de mise à jour non autorisé: | {"metadata":{}}
2025-01-03 17:08:59 [WARN]: Comportement suspect détecté: | {"metadata":{"userId":5232913097}}
2025-01-03 17:09:17 [WARN]: Comportement suspect détecté: | {"metadata":{"userId":5232913097}}
2025-01-03 17:11:52 [ERROR]: Erreur lors de la récupération/création de l'utilisateur: Cannot read properties of undefined (reading 'toLowerCase') | {"metadata":{"stack":"TypeError: Cannot read properties of undefined (reading 'toLowerCase')\n    at model.<anonymous> (C:\\Users\\MSI\\Desktop\\project\\jiro\\models\\User.js:490:49)\n    at callMiddlewareFunction (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\kareem\\index.js:628:27)\n    at model.next (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\kareem\\index.js:93:7)\n    at _next (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\kareem\\index.js:146:10)\n    at C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\kareem\\index.js:653:30\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)"}}
2025-01-03 17:11:52 [ERROR]: Erreur dans le gestionnaire de session: Cannot read properties of undefined (reading 'toLowerCase') | {"metadata":{"stack":"TypeError: Cannot read properties of undefined (reading 'toLowerCase')\n    at model.<anonymous> (C:\\Users\\MSI\\Desktop\\project\\jiro\\models\\User.js:490:49)\n    at callMiddlewareFunction (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\kareem\\index.js:628:27)\n    at model.next (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\kareem\\index.js:93:7)\n    at _next (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\kareem\\index.js:146:10)\n    at C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\kareem\\index.js:653:30\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)"}}
2025-01-03 17:11:52 [WARN]: Comportement suspect détecté: | {"metadata":{"userId":6789016810}}
2025-01-04 10:53:07 [ERROR]: Erreur surveillance commandes en attente: getaddrinfo ENOTFOUND jiroshop-shard-00-01.umpsu.mongodb.net | {"metadata":{"reason":{"type":"ReplicaSetNoPrimary","servers":{"jiroshop-shard-00-01.umpsu.mongodb.net:27017":{"address":"jiroshop-shard-00-01.umpsu.mongodb.net:27017","type":"Unknown","hosts":[],"passives":[],"arbiters":[],"tags":{},"minWireVersion":0,"maxWireVersion":0,"roundTripTime":-1,"minRoundTripTime":0,"lastUpdateTime":230495625,"lastWriteDate":0,"error":{},"topologyVersion":null,"setName":null,"setVersion":null,"electionId":null,"logicalSessionTimeoutMinutes":null,"maxMessageSizeBytes":null,"maxWriteBatchSize":null,"maxBsonObjectSize":null,"primary":null,"me":null,"$clusterTime":null,"iscryptd":false},"jiroshop-shard-00-02.umpsu.mongodb.net:27017":{"address":"jiroshop-shard-00-02.umpsu.mongodb.net:27017","type":"Unknown","hosts":[],"passives":[],"arbiters":[],"tags":{},"minWireVersion":0,"maxWireVersion":0,"roundTripTime":-1,"minRoundTripTime":0,"lastUpdateTime":230495626,"lastWriteDate":0,"error":{},"topologyVersion":null,"setName":null,"setVersion":null,"electionId":null,"logicalSessionTimeoutMinutes":null,"maxMessageSizeBytes":null,"maxWriteBatchSize":null,"maxBsonObjectSize":null,"primary":null,"me":null,"$clusterTime":null,"iscryptd":false},"jiroshop-shard-00-00.umpsu.mongodb.net:27017":{"address":"jiroshop-shard-00-00.umpsu.mongodb.net:27017","type":"Unknown","hosts":[],"passives":[],"arbiters":[],"tags":{},"minWireVersion":0,"maxWireVersion":0,"roundTripTime":-1,"minRoundTripTime":0,"lastUpdateTime":230495627,"lastWriteDate":0,"error":{},"topologyVersion":null,"setName":null,"setVersion":null,"electionId":null,"logicalSessionTimeoutMinutes":null,"maxMessageSizeBytes":null,"maxWriteBatchSize":null,"maxBsonObjectSize":null,"primary":null,"me":null,"$clusterTime":null,"iscryptd":false}},"stale":false,"compatible":true,"heartbeatFrequencyMS":10000,"localThresholdMS":15,"setName":"atlas-qy49pv-shard-0","maxElectionId":{"$oid":"7fffffff00000000000000ba"},"maxSetVersion":15,"commonWireVersion":0,"logicalSessionTimeoutMinutes":null},"stack":"MongoServerSelectionError: getaddrinfo ENOTFOUND jiroshop-shard-00-01.umpsu.mongodb.net\n    at Topology.selectServer (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\sdam\\topology.js:320:38)\n    at async tryOperation (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\operations\\execute_operation.js:143:18)\n    at async executeOperation (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\operations\\execute_operation.js:73:16)\n    at async FindCursor._initialize (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\cursor\\find_cursor.js:60:26)\n    at async FindCursor.cursorInit (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:607:27)\n    at async FindCursor.fetchBatch (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:641:13)\n    at async FindCursor.next (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:323:17)\n    at async [Symbol.asyncIterator] (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:240:34)\n    at async FindCursor.toArray (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:400:26)\n    at async model.Query._find (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongoose\\lib\\query.js:2363:14)","cause":{}}}
2025-01-04 10:53:07 [ERROR]: Erreur surveillance messages non lus: getaddrinfo ENOTFOUND jiroshop-shard-00-01.umpsu.mongodb.net | {"metadata":{"reason":{"type":"ReplicaSetNoPrimary","servers":{"jiroshop-shard-00-01.umpsu.mongodb.net:27017":{"address":"jiroshop-shard-00-01.umpsu.mongodb.net:27017","type":"Unknown","hosts":[],"passives":[],"arbiters":[],"tags":{},"minWireVersion":0,"maxWireVersion":0,"roundTripTime":-1,"minRoundTripTime":0,"lastUpdateTime":230495625,"lastWriteDate":0,"error":{},"topologyVersion":null,"setName":null,"setVersion":null,"electionId":null,"logicalSessionTimeoutMinutes":null,"maxMessageSizeBytes":null,"maxWriteBatchSize":null,"maxBsonObjectSize":null,"primary":null,"me":null,"$clusterTime":null,"iscryptd":false},"jiroshop-shard-00-02.umpsu.mongodb.net:27017":{"address":"jiroshop-shard-00-02.umpsu.mongodb.net:27017","type":"Unknown","hosts":[],"passives":[],"arbiters":[],"tags":{},"minWireVersion":0,"maxWireVersion":0,"roundTripTime":-1,"minRoundTripTime":0,"lastUpdateTime":230495626,"lastWriteDate":0,"error":{},"topologyVersion":null,"setName":null,"setVersion":null,"electionId":null,"logicalSessionTimeoutMinutes":null,"maxMessageSizeBytes":null,"maxWriteBatchSize":null,"maxBsonObjectSize":null,"primary":null,"me":null,"$clusterTime":null,"iscryptd":false},"jiroshop-shard-00-00.umpsu.mongodb.net:27017":{"address":"jiroshop-shard-00-00.umpsu.mongodb.net:27017","type":"Unknown","hosts":[],"passives":[],"arbiters":[],"tags":{},"minWireVersion":0,"maxWireVersion":0,"roundTripTime":-1,"minRoundTripTime":0,"lastUpdateTime":230495627,"lastWriteDate":0,"error":{},"topologyVersion":null,"setName":null,"setVersion":null,"electionId":null,"logicalSessionTimeoutMinutes":null,"maxMessageSizeBytes":null,"maxWriteBatchSize":null,"maxBsonObjectSize":null,"primary":null,"me":null,"$clusterTime":null,"iscryptd":false}},"stale":false,"compatible":true,"heartbeatFrequencyMS":10000,"localThresholdMS":15,"setName":"atlas-qy49pv-shard-0","maxElectionId":{"$oid":"7fffffff00000000000000ba"},"maxSetVersion":15,"commonWireVersion":0,"logicalSessionTimeoutMinutes":null},"stack":"MongoServerSelectionError: getaddrinfo ENOTFOUND jiroshop-shard-00-01.umpsu.mongodb.net\n    at Topology.selectServer (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\sdam\\topology.js:320:38)\n    at async tryOperation (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\operations\\execute_operation.js:143:18)\n    at async executeOperation (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\operations\\execute_operation.js:73:16)\n    at async FindCursor._initialize (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\cursor\\find_cursor.js:60:26)\n    at async FindCursor.cursorInit (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:607:27)\n    at async FindCursor.fetchBatch (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:641:13)\n    at async FindCursor.next (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:323:17)\n    at async [Symbol.asyncIterator] (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:240:34)\n    at async FindCursor.toArray (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:400:26)\n    at async model.Query._find (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongoose\\lib\\query.js:2363:14)","cause":{}}}
2025-01-04 10:53:07 [ERROR]: Erreur nettoyage commandes expirées: getaddrinfo ENOTFOUND jiroshop-shard-00-01.umpsu.mongodb.net | {"metadata":{"reason":{"type":"ReplicaSetNoPrimary","servers":{"jiroshop-shard-00-01.umpsu.mongodb.net:27017":{"address":"jiroshop-shard-00-01.umpsu.mongodb.net:27017","type":"Unknown","hosts":[],"passives":[],"arbiters":[],"tags":{},"minWireVersion":0,"maxWireVersion":0,"roundTripTime":-1,"minRoundTripTime":0,"lastUpdateTime":230495625,"lastWriteDate":0,"error":{},"topologyVersion":null,"setName":null,"setVersion":null,"electionId":null,"logicalSessionTimeoutMinutes":null,"maxMessageSizeBytes":null,"maxWriteBatchSize":null,"maxBsonObjectSize":null,"primary":null,"me":null,"$clusterTime":null,"iscryptd":false},"jiroshop-shard-00-02.umpsu.mongodb.net:27017":{"address":"jiroshop-shard-00-02.umpsu.mongodb.net:27017","type":"Unknown","hosts":[],"passives":[],"arbiters":[],"tags":{},"minWireVersion":0,"maxWireVersion":0,"roundTripTime":-1,"minRoundTripTime":0,"lastUpdateTime":230495626,"lastWriteDate":0,"error":{},"topologyVersion":null,"setName":null,"setVersion":null,"electionId":null,"logicalSessionTimeoutMinutes":null,"maxMessageSizeBytes":null,"maxWriteBatchSize":null,"maxBsonObjectSize":null,"primary":null,"me":null,"$clusterTime":null,"iscryptd":false},"jiroshop-shard-00-00.umpsu.mongodb.net:27017":{"address":"jiroshop-shard-00-00.umpsu.mongodb.net:27017","type":"Unknown","hosts":[],"passives":[],"arbiters":[],"tags":{},"minWireVersion":0,"maxWireVersion":0,"roundTripTime":-1,"minRoundTripTime":0,"lastUpdateTime":230495627,"lastWriteDate":0,"error":{},"topologyVersion":null,"setName":null,"setVersion":null,"electionId":null,"logicalSessionTimeoutMinutes":null,"maxMessageSizeBytes":null,"maxWriteBatchSize":null,"maxBsonObjectSize":null,"primary":null,"me":null,"$clusterTime":null,"iscryptd":false}},"stale":false,"compatible":true,"heartbeatFrequencyMS":10000,"localThresholdMS":15,"setName":"atlas-qy49pv-shard-0","maxElectionId":{"$oid":"7fffffff00000000000000ba"},"maxSetVersion":15,"commonWireVersion":0,"logicalSessionTimeoutMinutes":null},"stack":"MongoServerSelectionError: getaddrinfo ENOTFOUND jiroshop-shard-00-01.umpsu.mongodb.net\n    at Topology.selectServer (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\sdam\\topology.js:320:38)\n    at async tryOperation (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\operations\\execute_operation.js:143:18)\n    at async executeOperation (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\operations\\execute_operation.js:73:16)\n    at async FindCursor._initialize (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\cursor\\find_cursor.js:60:26)\n    at async FindCursor.cursorInit (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:607:27)\n    at async FindCursor.fetchBatch (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:641:13)\n    at async FindCursor.next (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:323:17)\n    at async [Symbol.asyncIterator] (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:240:34)\n    at async FindCursor.toArray (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:400:26)\n    at async model.Query._find (C:\\Users\\MSI\\Desktop\\project\\jiro\\node_modules\\mongoose\\lib\\query.js:2363:14)","cause":{}}}
